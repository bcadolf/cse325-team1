@page "/login"
@inject cse325_team1.Data.Services.AuthService Auth
@inject NavigationManager Nav

<div class="card">
    <h1 class="h1">Login</h1>
    <p class="p">Welcome back. Enter your credentials.</p>

    <div class="form-row">
        <label>Username</label>
        <input @bind="username" />
    </div>

    <div class="form-row">
        <label>Password</label>
        <input type="password" @bind="password" />
    </div>

    <div class="actions">
        <button class="btn primary" @onclick="DoLogin">Login</button>
        <a class="btn ghost" href="/signup">Create account</a>
    </div>

    @if (!string.IsNullOrWhiteSpace(msg))
    {
        <div class="err">@msg</div>
    }
</div>

@code {
    private string username = "";
    private string password = "";
    private string? msg;

    private async Task DoLogin()
    {
        var (ok, message) = await Auth.LoginAsync(username, password);
        if (!ok) { msg = message; return; }

        Nav.NavigateTo("/journals", forceLoad: false);
    }
}
